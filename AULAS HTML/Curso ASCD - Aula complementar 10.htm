<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="pt-br" lang="pt-br"><head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Curso ASCD - Aula complementar 10</title>
<link rel="stylesheet" href="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/curso_inet.css" type="text/css">

</head>
<body>
<style type="text/css">
	body { background-image: url("../images_fixas/01-fundo_clean.jpg");
	                 
     
      background-attachment: fixed;
	
	}
</style>

<div id="tudo2">
<div id="conteudo">
<p>

</p><div id="reader">
<center>
<img style="border: 0px solid ; width: 794px; height: 200px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/projeto_reader_ascd.png"><br>
</center>
</div>



<div id="login">

<center>
Arquitetura e Segurança em Comunicação de Dados
</center>
<br>
<table style="text-align: left; width: 735px; height: 140px;" border="0" cellpadding="2" cellspacing="2">
  <tbody>
    <tr>
      <td><img style="border: 0px solid ; width: 96px; height: 151px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/box_ascd_p.png"></td>
      <td>
      <form method="post" action="index.php?aut=7023744f430c17b8779c40f8fc319bfe&amp;cont=YW5kcmVlZWVtYWNoYWRvQGdtYWlsLmNvbQ==&amp;id=">
        <table style="text-align: left; width: 186px; height: 72px;" border="0" cellpadding="2" cellspacing="2">
          <tbody>
            <tr>
              <td style="font-family: Verdana;">Aula:</td>
              <td style="font-family: Verdana;">10 de 48</td>
            </tr>
            <tr>
              <td style="font-family: Verdana;">Login:</td>
              <td style="font-family: Verdana;"><input name="login" size="30" maxlenght="10" type="login"></td>
            </tr>
            <tr>
              <td style="font-family: Verdana;">Pass:</td>
              <td style="font-family: Verdana;"><input name="pass" value="" size="30" maxlenght="10" type="password"></td>
            </tr>
            <tr>
              <td></td>
              <td><input value=" Enviar " type="submit"></td>
            </tr>
          </tbody>
        </table>
      </form>
      </td>
      <td>
      <div style="text-align: right;"><br style="font-family: Verdana;">
      </div>
      <img style="border: 0px solid ; width: 42px; height: 80px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/spacer.gif"></td>
      <td>
      <div style="text-align: right;"><small>&nbsp; &nbsp;
Obrigado
por participar de nosso curso.<br>
Qualquer dúvida estamos à sua
disposição.<br></small>
      </div>
      <br style="font-family: Verdana;">
      <div style="text-align: right;"><small>Atenciosamente<br style="font-family: Verdana;">
Equipe Insecuritynet<br></small>
      <br>
      </div>
      </td>
    </tr>
  </tbody>
</table>
</div>


<br>
<div id="logon">
<center><br>
<table style="text-align: left; width: 240px; height: 48px;" border="0" cellpadding="2" cellspacing="2">
  <tbody>
    <tr>
      <td style="border: 0px solid ; width: 43px;"><img style="border: 0px solid ; width: 42px; height: 36px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/ico-concluido.png"></td>
      <td><span style="font-weight: bold; color: rgb(0, 0, 0);">Aula Complementar</span></td>
    </tr>
  </tbody>
</table>


</center>
<div id="aula">
<!-- INIAULA -->
<br>
<div id="barra">
</div><br>
<span style="font-weight: bold; color: rgb(0, 102, 0);">Sobre a questão 2 da aula 10</span><br>
<b>O que corresponde -P no TCP tables?</b><br>
Resposta correta:<i>Permitido desde que o restante da conexão não seja bloqueado por outro item da tabela</i><br><br><br>


<br><br><br>
<div id="barra">
</div><br>
<span style="font-weight: bold; color: rgb(0, 102, 0);">Sobre a questão 3 da aula 10</span><br>
<b>O que corresponde +B no TCP tables?</b><br>
Resposta correta:<i>Item Bloqueado</i><br><br><br>

<br><br><br><div id="barra">
</div><br><span style="font-weight: bold;"><big style="color: rgb(0, 102, 0);">Solução de Firewall</big></span><br>
<br>
O TCP Tables, foi desenvolvido apenas para fins didáticos.<br>
O TCP Tables possibilita você entender como IP local, IP remoto,
Porta Local, Porta Remota e Processos se relacionam em uma
conexão e principalmente possibilita a você criar regras
para permitir apenas conexões seguras.<br><br>
<i>Mas se o TCP Tables é apenas para fins didáticos, onde
encontrar um software similar para criar regras de defesa em meu
computador?</i><br>
A melhor opção de Firewall atual, é o Iptables.<br>
<br>
O Iptables é um firewall em nível de pacotes e funciona
baseado no endereço/porta de origem/destino do pacote,
prioridade, etc. Ele funciona através da
comparação de regras para saber se um pacote tem ou
não permissão para passar.<br>
<br>
Na aula complementar 06, temos uma maquina virtual Linux já configurada com Iptables.<br>
O Iptables é um software Linux, muito utilizado para proteção de redes Linux ou Windows.<br>
Caso você possua uma rede com computadores Windows e queira
instalar um firewall Iptables, você pode usar a seguinte
configuração.<br>
<br>

<embed style="width: 633px; height: 289px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_001.swf">
<br>
<br>
&nbsp;<br>
<br>
Assim como vimos no TCP tables, o IP tables funciona através de regras.<br>
Você cria as regras de defesa de acordo com sua necessidade.<br>
No Iptables as regras são definidas através de comandos
(como do prompt de comando) e podem serem salvas como script.<br><br>
<big style="font-weight: bold;">Iptables na
prática.</big><br><br>
Vamos criar uma regra que bloqueie todas as conexões e
permita apenas conexões de websites (porta 80)<br>

<br>
Abra a maquina virtual Linux da aula complementar 06<br>
<br>
Verifique a conexao com a internet em sua maquina virtual, acesse qualquer site:<br>
<br>

<embed style="width: 512px; height: 452px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_002.swf">
<br>
<br>
Abra o console<br>
<br>

<embed style="width: 543px; height: 348px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_003.swf">
<br>
&nbsp;<br>
<br>
Agora vamos limpar todas as regras existentes no Iptables<br>
<br>
Comando:<br>
<span style="color: rgb(51, 51, 0);">sudo iptables -F</span><br>
<br>

<embed style="width: 410px; height: 184px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_004.swf">
<br>
<br>
É necessario logar como root.<br>
A senha do root é: <span style="color: rgb(51, 51, 0);">password</span> &nbsp;(a senha não será exibida durante a digitação)<br>
<br>

<embed style="width: 428px; height: 157px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_005.swf">
<br>
<br>
Vamos bloquear todas as conexões<br>
<br>
<span style="color: rgb(51, 51, 0);">sudo iptables -P INPUT DROP</span><br style="color: rgb(51, 51, 0);">
<span style="color: rgb(51, 51, 0);">sudo iptables -P OUPUT DROP</span><br style="color: rgb(51, 51, 0);">
<span style="color: rgb(51, 51, 0);">sudo iptables -P FORWARD DROP</span><br>
<br>

<embed style="width: 466px; height: 86px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_006.swf">
<br>
<br>
Veja que após bloquer todas as conexões nenhum site irá abrir.<br>
<br>

<embed style="width: 471px; height: 367px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_007.swf">
<br>
<br>
<br>
Agora vamos liberar a entradas de pacotes vindas da porta remota 80 (servidores HTTP)<br>
<br style="color: rgb(51, 51, 0);">
<span style="color: rgb(51, 51, 0);">sudo iptables -A INPUT -p tcp --sport 80 -j ACCEPT</span><br style="color: rgb(51, 51, 0);">
<span style="color: rgb(51, 51, 0);">sudo iptables -A INPUT -p udp --sport 80 -j ACCEPT</span><br>
<br>

<embed style="width: 680px; height: 48px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_008.swf">
<br>
<br>
Agora vamos liberar a saída de pacotes de nosso computador que seja destinado à um servidor HTTP (porta 80)<br>
<br>
<span style="color: rgb(51, 51, 0);">sudo iptables -A OUTPUT -p tcp --sport 25000:65535 --dport 80 -j ACCEPT</span><br style="color: rgb(51, 51, 0);">
<span style="color: rgb(51, 51, 0);">sudo iptables -A OUTPUT -p udp --sport 25000:65535 --dport 80 -j ACCEPT</span><br>
<br>

<embed style="width: 698px; height: 72px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_009.swf">
<br>
&nbsp;<br>
Agorara vamos liberar o acesso á servidores DNS para resolução de endereços dos sites<br>
<br style="color: rgb(51, 51, 0);">
<span style="color: rgb(51, 51, 0);">sudo iptables -A OUTPUT -p tcp --sport 25000:65535 --dport 53 -j ACCEPT</span><br style="color: rgb(51, 51, 0);">
<span style="color: rgb(51, 51, 0);">sudo iptables -A OUTPUT -p udp --sport 25000:65535 --dport 53 -j ACCEPT</span><br>
<br>

<embed style="width: 697px; height: 21px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_010.swf">
<br>

<embed style="width: 697px; height: 21px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_010.swf">
<br>
<br>
Agora vamos deixar entrar somente o que foi relacionado e estabilizado pelo próprio computador<br>
<br>
<span style="color: rgb(51, 51, 0);">sudo iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br>
<br>

<embed style="width: 698px; height: 17px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_011.swf">
<br>
<br>
Vamos visualizar as regras ativas no Iptables<br>
Comando:<br>
<span style="color: rgb(51, 51, 0);">&nbsp;iptables –L<br>
<br>

<embed style="width: 697px; height: 345px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_012.swf">
<br>
</span>&nbsp;<br>
Veja que agora&nbsp; conseguimos conectar<br>
<br>

<embed style="width: 522px; height: 406px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/img_013.swf">
<br>
<br>
<span style="font-weight: bold;"><big style="color: rgb(204, 0, 0);"><big>Importante:</big></big><br>
<br>
</span>Esta regra foi apenas um exemplo de como o Iptables é utilizado, nem é uma regra segura.<br>
A segurança depende de muitas outras regras. Não existe
uma padrão de regra, cada usuário possui uma necessidade
diferente.<br>
<br>
Esta aula é apenas uma demonstração do Iptables,
por este motivo os comandos não estão explicados com
detalhes.<br>
&nbsp;A explicação detalhada de como utilizar o Iptables e os comandos Linux caberia em um novo curso.<br>
<br>
Caso você queira utilizar a internet normalmente na maquina
virtual limpe o Iptables, pois agora ele permite apenas conexões
nas portas 80 e 53<br>
<br>
Comando para limpar:<br>
<span style="color: rgb(51, 51, 0);">sudo iptables -F</span><br>
<br>
<!-- FIMAULA -->
</div>



<center>
<br>
<img style="border: 0px solid ; width: 800px; height: 50px;" alt="" src="Curso%20ASCD%20-%20Aula%20complementar%2010_arquivos/protecao_inteletual.png">
</center>
<p></p>
</div>
<div id="rodape_normal">
    <p>
    Todos Direitos Reservados - <a href="http://www.insecuritynet.com.br/"><strong>Insecuritynet</strong></a> - 2012
    </p>
    </div>
	
    </div>
    
    </div></body></html>